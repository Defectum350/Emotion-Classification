# Emotion-Classification
## В данном проекте реализовано два алгоритма по распознаванию лица человека на фотографии и дальнейшей классификации эмоций 
### Первыми действиями были определенны два каталога с фотографиями для тренировки и для теста

<img src="https://github.com/Defectum350/images/blob/main/%D1%8D%D0%BC%D0%BE%D1%86%D0%B8%D0%B8/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202023-01-10%20000828.png?raw=true
"/>

### Как мы можем заметить в нашем коллекции преобладают фотографии со счастливыми людьми, а остальные классы постепенно убывают в своем количество, пока не появляется пропасть
### в виде фотографий с отвращением, которых всего 436 штук

<img src="https://github.com/Defectum350/images/blob/main/%D1%8D%D0%BC%D0%BE%D1%86%D0%B8%D0%B8/%D0%91%D0%B5%D0%B7%20%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20(26).png?raw=true"/>

<img src="https://github.com/Defectum350/images/blob/main/%D1%8D%D0%BC%D0%BE%D1%86%D0%B8%D0%B8/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202023-01-10%20000920.png?raw=true"/>

### Реализовав функцию по выгрузке одной случайной фотографии каждого класса можно заметить, что они были предварительно обработаны в области разрешения

<img src="https://github.com/Defectum350/images/blob/main/%D1%8D%D0%BC%D0%BE%D1%86%D0%B8%D0%B8/%D0%91%D0%B5%D0%B7%20%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F.png?raw=true"/>

### Далее мы при помощи ImageDateGenerator генерим большее количество фотографий с небольшими изменениями оригинала с целью искусственного увеличения представителей различных классов
### После всех операций с каталогами, необходимо определиться с тем какая нейронная модель будет использоваться для классификации эмоций на лицах людей
### В модели мы определяем val_loss - это значение функции стоимости для наших данных перекрестной проверки, а потеря - это значение функции стоимости для наших обучающих данных
### По данным проверки нейроны, использубщие отсев, не отбрасывают случайные нейроны.
### Причина в том, что во время обучения мы используем выпадение, чтобы добавить немного шума, дабы избежать переобучения.
### При расчете перекрестной проверки мы находимя на этапе отзыва, а не на этапе обучения, что ползволяет нам использовать все возможные сети.
### Для ранней остановки используем val_accuracy

<img src="https://github.com/Defectum350/images/blob/main/%D1%8D%D0%BC%D0%BE%D1%86%D0%B8%D0%B8/%D0%91%D0%B5%D0%B7%20%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20(1).png?raw=true"/>

### Наша модель состоит сперва из сверточных слоев, которые дополняются батч нормализацией, максимальным пулингом и дропаутом
### Когда наша модель выделила признаки из фотографий она направляет их через линейные слои модели, количество нейронов в которых постепеннь уменьшается до 7
### Оставшиеся 7 нейронов - это наши выходные классы по одному на каждый, с использованием softmax 
### Сама модель использует оптимизатор Adam, категориальную кроссэнтропию как потерю, а метрикой качества является точность

<img src="https://github.com/Defectum350/images/blob/main/%D1%8D%D0%BC%D0%BE%D1%86%D0%B8%D0%B8/%D0%91%D0%B5%D0%B7%20%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20(2).png?raw=true"/>

### После обучения и получения точности равной 65%, мы можем убедиться, что наша модель в распознавании сохраняет дисбаланс по отношению к тем классам, представителей которых было недостаточно

<img src="https://github.com/Defectum350/images/blob/main/%D1%8D%D0%BC%D0%BE%D1%86%D0%B8%D0%B8/%D0%91%D0%B5%D0%B7%20%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20(3).png?raw=true"/>

### На некоторых фотографией даже человеческий глаз не всегда может определить точный класс, так на крайней левой фотографии трудно определить грусть это или страх
## MTCNN
### В качестве модели детекции лиц была выбрана Multi-task Cascaded Convolutional Networks, так как показала наилучшие показатели с нашей нейронной сетью по классификации эмоций

<img src="https://github.com/Defectum350/images/blob/main/%D1%8D%D0%BC%D0%BE%D1%86%D0%B8%D0%B8/%D0%91%D0%B5%D0%B7%20%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20(4).png?raw=true"/>

### Объединив две модели и реализовав небольшой алгоритм мы можем наблюдать, что наша конечная работа отлично справляется с распознаванием эмоцией у большого числа людей одновременно
#### те результаты, в которых модель не уверена обводятся в красный квадрат
